services:
  api:
    image: ghcr.io/renedierking/landalf-api:latest
    container_name: landalf-api
    network_mode: host
    environment:
      - ASPNETCORE_URLS=http://+:5000
      - Cors__FrontendUrl=http://localhost # Adjust if NGINX_PORT != 80, e.g. http://localhost:8080
      # Docker Desktop (Windows/macOS): WoL auto-detection sees the VM's virtual NIC, not your
      # real LAN. Uncomment and set your LAN broadcast address for magic packets to reach devices.
      # Example: 192.168.178.255 for a 192.168.178.0/24 network.
      # On Linux with network_mode: host you can usually leave this commented out.
      # - WOL_BROADCASTS=192.168.178.255
      - Serilog__MinimumLevel__Default=Information
      - Serilog__MinimumLevel__Override__Microsoft.AspNetCore=Warning
      - Serilog__MinimumLevel__Override__Microsoft.EntityFrameworkCore=Warning
    volumes:
      - api-data:/app/LANdalf_Data
      - api-logs:/app/logs
    restart: unless-stopped

  ui:
    image: ghcr.io/renedierking/landalf-ui:latest
    container_name: landalf-ui
    network_mode: host
    environment:
      - NGINX_PORT=80 # Change to any free port, then update Cors__FrontendUrl above
    depends_on:
      - api
    restart: unless-stopped
volumes:
  api-data:
  api-logs:
